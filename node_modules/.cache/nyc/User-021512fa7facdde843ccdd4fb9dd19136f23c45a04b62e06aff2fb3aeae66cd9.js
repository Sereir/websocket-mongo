function cov_3su57mbgz(){var path="C:\\Users\\Nacim\\Documents\\websocket-mongo\\src\\models\\User.js";var hash="344d53a0d0afe00184a4d4e236437e264e533e22";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\Users\\Nacim\\Documents\\websocket-mongo\\src\\models\\User.js",statementMap:{"0":{start:{line:1,column:17},end:{line:1,column:36}},"1":{start:{line:2,column:15},end:{line:2,column:32}},"2":{start:{line:4,column:19},end:{line:47,column:1}},"3":{start:{line:50,column:0},end:{line:59,column:3}},"4":{start:{line:51,column:2},end:{line:51,column:50}},"5":{start:{line:51,column:36},end:{line:51,column:50}},"6":{start:{line:52,column:2},end:{line:58,column:3}},"7":{start:{line:53,column:23},end:{line:53,column:25}},"8":{start:{line:54,column:4},end:{line:54,column:65}},"9":{start:{line:55,column:4},end:{line:55,column:11}},"10":{start:{line:57,column:4},end:{line:57,column:14}},"11":{start:{line:62,column:0},end:{line:64,column:2}},"12":{start:{line:63,column:2},end:{line:63,column:50}},"13":{start:{line:66,column:0},end:{line:66,column:52}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:50,column:23},end:{line:50,column:24}},loc:{start:{line:50,column:45},end:{line:59,column:1}},line:50},"1":{name:"(anonymous_1)",decl:{start:{line:62,column:37},end:{line:62,column:38}},loc:{start:{line:62,column:64},end:{line:64,column:1}},line:62}},branchMap:{"0":{loc:{start:{line:51,column:2},end:{line:51,column:50}},type:"if",locations:[{start:{line:51,column:2},end:{line:51,column:50}},{start:{line:51,column:2},end:{line:51,column:50}}],line:51}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0},f:{"0":0,"1":0},b:{"0":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"344d53a0d0afe00184a4d4e236437e264e533e22"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_3su57mbgz=function(){return actualCoverage;};}return actualCoverage;}cov_3su57mbgz();const mongoose=(cov_3su57mbgz().s[0]++,require('mongoose'));const bcrypt=(cov_3su57mbgz().s[1]++,require('bcrypt'));const UserSchema=(cov_3su57mbgz().s[2]++,new mongoose.Schema({email:{type:String,required:true,unique:true,lowercase:true,trim:true},username:{type:String,required:true,unique:true,minlength:3,trim:true},password:{type:String,required:true,select:false// éviter de retourner par défaut
},avatar:{type:String,default:null},status:{type:String,enum:['online','offline'],default:'offline'},createdAt:{type:Date,default:Date.now,immutable:true},lastLogin:{type:Date,default:null}},{versionKey:false}));// Hash du mot de passe avant sauvegarde
cov_3su57mbgz().s[3]++;UserSchema.pre('save',async function(next){cov_3su57mbgz().f[0]++;cov_3su57mbgz().s[4]++;if(!this.isModified('password')){cov_3su57mbgz().b[0][0]++;cov_3su57mbgz().s[5]++;return next();}else{cov_3su57mbgz().b[0][1]++;}cov_3su57mbgz().s[6]++;try{const saltRounds=(cov_3su57mbgz().s[7]++,10);cov_3su57mbgz().s[8]++;this.password=await bcrypt.hash(this.password,saltRounds);cov_3su57mbgz().s[9]++;next();}catch(err){cov_3su57mbgz().s[10]++;next(err);}});// Méthode utilitaire pour vérifier le mot de passe
cov_3su57mbgz().s[11]++;UserSchema.methods.comparePassword=async function(candidate){cov_3su57mbgz().f[1]++;cov_3su57mbgz().s[12]++;return bcrypt.compare(candidate,this.password);};cov_3su57mbgz().s[13]++;module.exports=mongoose.model('User',UserSchema);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfM3N1NTdtYmd6IiwiYWN0dWFsQ292ZXJhZ2UiLCJtb25nb29zZSIsInMiLCJyZXF1aXJlIiwiYmNyeXB0IiwiVXNlclNjaGVtYSIsIlNjaGVtYSIsImVtYWlsIiwidHlwZSIsIlN0cmluZyIsInJlcXVpcmVkIiwidW5pcXVlIiwibG93ZXJjYXNlIiwidHJpbSIsInVzZXJuYW1lIiwibWlubGVuZ3RoIiwicGFzc3dvcmQiLCJzZWxlY3QiLCJhdmF0YXIiLCJkZWZhdWx0Iiwic3RhdHVzIiwiZW51bSIsImNyZWF0ZWRBdCIsIkRhdGUiLCJub3ciLCJpbW11dGFibGUiLCJsYXN0TG9naW4iLCJ2ZXJzaW9uS2V5IiwicHJlIiwibmV4dCIsImYiLCJpc01vZGlmaWVkIiwiYiIsInNhbHRSb3VuZHMiLCJoYXNoIiwiZXJyIiwibWV0aG9kcyIsImNvbXBhcmVQYXNzd29yZCIsImNhbmRpZGF0ZSIsImNvbXBhcmUiLCJtb2R1bGUiLCJleHBvcnRzIiwibW9kZWwiXSwic291cmNlcyI6WyJVc2VyLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IG1vbmdvb3NlID0gcmVxdWlyZSgnbW9uZ29vc2UnKTtcclxuY29uc3QgYmNyeXB0ID0gcmVxdWlyZSgnYmNyeXB0Jyk7XHJcblxyXG5jb25zdCBVc2VyU2NoZW1hID0gbmV3IG1vbmdvb3NlLlNjaGVtYShcclxuICB7XHJcbiAgICBlbWFpbDoge1xyXG4gICAgICB0eXBlOiBTdHJpbmcsXHJcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxyXG4gICAgICB1bmlxdWU6IHRydWUsXHJcbiAgICAgIGxvd2VyY2FzZTogdHJ1ZSxcclxuICAgICAgdHJpbTogdHJ1ZSxcclxuICAgIH0sXHJcbiAgICB1c2VybmFtZToge1xyXG4gICAgICB0eXBlOiBTdHJpbmcsXHJcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxyXG4gICAgICB1bmlxdWU6IHRydWUsXHJcbiAgICAgIG1pbmxlbmd0aDogMyxcclxuICAgICAgdHJpbTogdHJ1ZSxcclxuICAgIH0sXHJcbiAgICBwYXNzd29yZDoge1xyXG4gICAgICB0eXBlOiBTdHJpbmcsXHJcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxyXG4gICAgICBzZWxlY3Q6IGZhbHNlLCAvLyDDqXZpdGVyIGRlIHJldG91cm5lciBwYXIgZMOpZmF1dFxyXG4gICAgfSxcclxuICAgIGF2YXRhcjoge1xyXG4gICAgICB0eXBlOiBTdHJpbmcsXHJcbiAgICAgIGRlZmF1bHQ6IG51bGwsXHJcbiAgICB9LFxyXG4gICAgc3RhdHVzOiB7XHJcbiAgICAgIHR5cGU6IFN0cmluZyxcclxuICAgICAgZW51bTogWydvbmxpbmUnLCAnb2ZmbGluZSddLFxyXG4gICAgICBkZWZhdWx0OiAnb2ZmbGluZScsXHJcbiAgICB9LFxyXG4gICAgY3JlYXRlZEF0OiB7XHJcbiAgICAgIHR5cGU6IERhdGUsXHJcbiAgICAgIGRlZmF1bHQ6IERhdGUubm93LFxyXG4gICAgICBpbW11dGFibGU6IHRydWUsXHJcbiAgICB9LFxyXG4gICAgbGFzdExvZ2luOiB7XHJcbiAgICAgIHR5cGU6IERhdGUsXHJcbiAgICAgIGRlZmF1bHQ6IG51bGwsXHJcbiAgICB9LFxyXG4gIH0sXHJcbiAge1xyXG4gICAgdmVyc2lvbktleTogZmFsc2UsXHJcbiAgfVxyXG4pO1xyXG5cclxuLy8gSGFzaCBkdSBtb3QgZGUgcGFzc2UgYXZhbnQgc2F1dmVnYXJkZVxyXG5Vc2VyU2NoZW1hLnByZSgnc2F2ZScsIGFzeW5jIGZ1bmN0aW9uIChuZXh0KSB7XHJcbiAgaWYgKCF0aGlzLmlzTW9kaWZpZWQoJ3Bhc3N3b3JkJykpIHJldHVybiBuZXh0KCk7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHNhbHRSb3VuZHMgPSAxMDtcclxuICAgIHRoaXMucGFzc3dvcmQgPSBhd2FpdCBiY3J5cHQuaGFzaCh0aGlzLnBhc3N3b3JkLCBzYWx0Um91bmRzKTtcclxuICAgIG5leHQoKTtcclxuICB9IGNhdGNoIChlcnIpIHtcclxuICAgIG5leHQoZXJyKTtcclxuICB9XHJcbn0pO1xyXG5cclxuLy8gTcOpdGhvZGUgdXRpbGl0YWlyZSBwb3VyIHbDqXJpZmllciBsZSBtb3QgZGUgcGFzc2VcclxuVXNlclNjaGVtYS5tZXRob2RzLmNvbXBhcmVQYXNzd29yZCA9IGFzeW5jIGZ1bmN0aW9uIChjYW5kaWRhdGUpIHtcclxuICByZXR1cm4gYmNyeXB0LmNvbXBhcmUoY2FuZGlkYXRlLCB0aGlzLnBhc3N3b3JkKTtcclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gbW9uZ29vc2UubW9kZWwoJ1VzZXInLCBVc2VyU2NoZW1hKTtcclxuIl0sIm1hcHBpbmdzIjoibzhEQWVZO0FBQUFBLGFBQUEsU0FBQUEsQ0FBQSxTQUFBQyxjQUFBLFdBQUFBLGNBQUEsRUFBQUQsYUFBQSxHQWZaLEtBQU0sQ0FBQUUsUUFBUSxFQUFBRixhQUFBLEdBQUFHLENBQUEsTUFBR0MsT0FBTyxDQUFDLFVBQVUsQ0FBQyxFQUNwQyxLQUFNLENBQUFDLE1BQU0sRUFBQUwsYUFBQSxHQUFBRyxDQUFBLE1BQUdDLE9BQU8sQ0FBQyxRQUFRLENBQUMsRUFFaEMsS0FBTSxDQUFBRSxVQUFVLEVBQUFOLGFBQUEsR0FBQUcsQ0FBQSxNQUFHLEdBQUksQ0FBQUQsUUFBUSxDQUFDSyxNQUFNLENBQ3BDLENBQ0VDLEtBQUssQ0FBRSxDQUNMQyxJQUFJLENBQUVDLE1BQU0sQ0FDWkMsUUFBUSxDQUFFLElBQUksQ0FDZEMsTUFBTSxDQUFFLElBQUksQ0FDWkMsU0FBUyxDQUFFLElBQUksQ0FDZkMsSUFBSSxDQUFFLElBQ1IsQ0FBQyxDQUNEQyxRQUFRLENBQUUsQ0FDUk4sSUFBSSxDQUFFQyxNQUFNLENBQ1pDLFFBQVEsQ0FBRSxJQUFJLENBQ2RDLE1BQU0sQ0FBRSxJQUFJLENBQ1pJLFNBQVMsQ0FBRSxDQUFDLENBQ1pGLElBQUksQ0FBRSxJQUNSLENBQUMsQ0FDREcsUUFBUSxDQUFFLENBQ1JSLElBQUksQ0FBRUMsTUFBTSxDQUNaQyxRQUFRLENBQUUsSUFBSSxDQUNkTyxNQUFNLENBQUUsS0FBTztBQUNqQixDQUFDLENBQ0RDLE1BQU0sQ0FBRSxDQUNOVixJQUFJLENBQUVDLE1BQU0sQ0FDWlUsT0FBTyxDQUFFLElBQ1gsQ0FBQyxDQUNEQyxNQUFNLENBQUUsQ0FDTlosSUFBSSxDQUFFQyxNQUFNLENBQ1pZLElBQUksQ0FBRSxDQUFDLFFBQVEsQ0FBRSxTQUFTLENBQUMsQ0FDM0JGLE9BQU8sQ0FBRSxTQUNYLENBQUMsQ0FDREcsU0FBUyxDQUFFLENBQ1RkLElBQUksQ0FBRWUsSUFBSSxDQUNWSixPQUFPLENBQUVJLElBQUksQ0FBQ0MsR0FBRyxDQUNqQkMsU0FBUyxDQUFFLElBQ2IsQ0FBQyxDQUNEQyxTQUFTLENBQUUsQ0FDVGxCLElBQUksQ0FBRWUsSUFBSSxDQUNWSixPQUFPLENBQUUsSUFDWCxDQUNGLENBQUMsQ0FDRCxDQUNFUSxVQUFVLENBQUUsS0FDZCxDQUNGLENBQUMsRUFFRDtBQUFBNUIsYUFBQSxHQUFBRyxDQUFBLE1BQ0FHLFVBQVUsQ0FBQ3VCLEdBQUcsQ0FBQyxNQUFNLENBQUUsZUFBZ0JDLElBQUksQ0FBRSxDQUFBOUIsYUFBQSxHQUFBK0IsQ0FBQSxNQUFBL0IsYUFBQSxHQUFBRyxDQUFBLE1BQzNDLEdBQUksQ0FBQyxJQUFJLENBQUM2QixVQUFVLENBQUMsVUFBVSxDQUFDLENBQUUsQ0FBQWhDLGFBQUEsR0FBQWlDLENBQUEsU0FBQWpDLGFBQUEsR0FBQUcsQ0FBQSxZQUFPLENBQUEyQixJQUFJLENBQUMsQ0FBQyxFQUFDLEtBQUE5QixhQUFBLEdBQUFpQyxDQUFBLFVBQUFqQyxhQUFBLEdBQUFHLENBQUEsTUFDaEQsR0FBSSxDQUNGLEtBQU0sQ0FBQStCLFVBQVUsRUFBQWxDLGFBQUEsR0FBQUcsQ0FBQSxNQUFHLEVBQUUsRUFBQ0gsYUFBQSxHQUFBRyxDQUFBLE1BQ3RCLElBQUksQ0FBQ2MsUUFBUSxDQUFHLEtBQU0sQ0FBQVosTUFBTSxDQUFDOEIsSUFBSSxDQUFDLElBQUksQ0FBQ2xCLFFBQVEsQ0FBRWlCLFVBQVUsQ0FBQyxDQUFDbEMsYUFBQSxHQUFBRyxDQUFBLE1BQzdEMkIsSUFBSSxDQUFDLENBQUMsQ0FDUixDQUFFLE1BQU9NLEdBQUcsQ0FBRSxDQUFBcEMsYUFBQSxHQUFBRyxDQUFBLE9BQ1oyQixJQUFJLENBQUNNLEdBQUcsQ0FBQyxDQUNYLENBQ0YsQ0FBQyxDQUFDLENBRUY7QUFBQXBDLGFBQUEsR0FBQUcsQ0FBQSxPQUNBRyxVQUFVLENBQUMrQixPQUFPLENBQUNDLGVBQWUsQ0FBRyxlQUFnQkMsU0FBUyxDQUFFLENBQUF2QyxhQUFBLEdBQUErQixDQUFBLE1BQUEvQixhQUFBLEdBQUFHLENBQUEsT0FDOUQsTUFBTyxDQUFBRSxNQUFNLENBQUNtQyxPQUFPLENBQUNELFNBQVMsQ0FBRSxJQUFJLENBQUN0QixRQUFRLENBQUMsQ0FDakQsQ0FBQyxDQUFDakIsYUFBQSxHQUFBRyxDQUFBLE9BRUZzQyxNQUFNLENBQUNDLE9BQU8sQ0FBR3hDLFFBQVEsQ0FBQ3lDLEtBQUssQ0FBQyxNQUFNLENBQUVyQyxVQUFVLENBQUMiLCJpZ25vcmVMaXN0IjpbXX0=